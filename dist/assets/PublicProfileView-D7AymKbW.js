import{d as F,u as H,m as R,c as o,a as e,t as c,y as I,p as T,b as p,f as w,F as x,n as C,z,i as U,k as $,q as P,r as g,s as y,j as G,o as s,h as O,l as Q}from"./index-DoIKaNgo.js";import{g as J}from"./streaks-3FQZ5a9Q.js";import{t as K}from"./analytics-d6VtY9gH.js";import{_ as W,P as X}from"./PostSkeleton-By8O5vwQ.js";import"./MediaCarousel.vue_vue_type_script_setup_true_lang-cAo-VpB0.js";import"./WorkoutCard.vue_vue_type_script_setup_true_lang-Cnp1jYFM.js";const Y={class:"min-h-screen bg-gray-50"},Z={key:0,class:"p-6 text-center"},ee={key:1,class:"p-6 text-center"},te={class:"text-gray-500 mb-4"},se={key:2,class:"pb-20"},oe={class:"bg-white border-b border-gray-200 p-6 text-center"},re={class:"w-24 h-24 mx-auto mb-4"},ae=["src","alt"],le={key:1,class:"w-full h-full rounded-full bg-gradient-to-br from-summit-600 to-summit-800 flex items-center justify-center text-white font-bold text-2xl ring-4 ring-white shadow-lg"},ie={class:"font-display text-2xl font-bold text-gray-900"},ne={class:"text-gray-500"},ue={class:"mt-2"},de={key:0,class:"mt-4 text-gray-700 max-w-sm mx-auto"},ce={key:1,class:"mt-4 inline-flex items-center gap-2 px-4 py-2 bg-valencia-50 border border-valencia-200 rounded-full"},pe={class:"font-semibold text-valencia-700"},me={key:0,class:"text-sm text-gray-500"},_e={key:2,class:"mt-4 max-w-sm mx-auto text-left bg-gray-50 rounded-xl p-4 space-y-3"},fe={key:0},ge={class:"text-sm text-gray-700"},ve={key:1,class:"flex gap-4 text-sm text-gray-600"},we={key:0,class:"flex items-center gap-1"},xe={key:1,class:"flex items-center gap-1"},ye={key:2},ke={class:"flex flex-wrap gap-2"},he=["href"],be={key:4},Ce={class:"mt-6 flex gap-3 justify-center"},Pe={class:"max-w-2xl mx-auto px-4 py-6"},je={key:0,class:"space-y-4"},Ae={key:1,class:"text-center py-12 bg-white rounded-lg border border-gray-200"},Me={key:2,class:"space-y-4"},Ne=F({__name:"PublicProfileView",setup(Be){const q=Q(),V=$(),E=H(),j=P(()=>q.params.username),a=g(null),l=g(null),m=g(null),k=g([]),A=g(!0),h=g(!0),L=P(()=>a.value?a.value.display_name.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2):"?"),M=P(()=>a.value?.id===E.user?.id);async function S(){try{const{data:i,error:t}=await y.from("profiles").select("*").eq("username",j.value).single();if(t||!i)throw t||new Error("Profile not found");if(a.value=i,K("profile_viewed",{viewed_user_id:i.id}),i.user_type==="coach"){const{data:f}=await y.from("coach_profiles").select("*").eq("id",i.id).single();l.value=f}m.value=await J(i.id),await N(i.id)}catch(i){console.error("Error loading profile:",i),a.value=null}finally{A.value=!1}}async function N(i){try{h.value=!0;const{data:t,error:f}=await y.from("posts").select(`
        *,
        author:profiles!author_id(*),
        media:post_media(*),
        workout_completion:workout_completions!posts_workout_completion_id_fkey(
          id,
          duration_minutes,
          overall_rpe,
          has_pb,
          completed_at,
          shared_exercise_ids,
          share_settings,
          assignment:workout_assignments!workout_completions_assignment_id_fkey(
            workout:workouts!workout_assignments_workout_id_fkey(
              id,
              name,
              description
            )
          )
        )
      `).eq("author_id",i).eq("visibility","public").order("created_at",{ascending:!1}).limit(20);if(f)throw f;const d=(t||[]).map(n=>{const v=Array.isArray(n.author)?n.author[0]:n.author,_=n.media||[];let r=Array.isArray(n.workout_completion)?n.workout_completion[0]??null:n.workout_completion??null;if(r){const u=Array.isArray(r.assignment)?r.assignment[0]??null:r.assignment??null;u&&(u.workout=Array.isArray(u.workout)?u.workout[0]??null:u.workout??null),r={...r,assignment:u}}return{...n,author:v,media:_,workout_completion:r}}),B=d.filter(n=>n.post_type==="workout"&&n.workout_completion);if(B.length>0){const n=B.map(_=>_.workout_completion.id),{data:v}=await y.from("exercise_results").select(`
          id,
          completion_id,
          is_pb,
          exercise:exercises!exercise_results_exercise_id_fkey(
            id, name, sets, reps, weight_kg, duration_seconds, distance_meters
          )
        `).in("completion_id",n);if(v){for(const r of v)Array.isArray(r.exercise)&&(r.exercise=r.exercise[0]??null);const _=new Map;for(const r of v){const u=_.get(r.completion_id)||[];u.push(r),_.set(r.completion_id,u)}for(const r of d)if(r.workout_completion){const u=r.workout_completion.shared_exercise_ids;let b=_.get(r.workout_completion.id)||[];u&&u.length>0&&(b=b.filter(D=>u.includes(D.exercise?.id))),r.workout_completion.exercise_results=b}}}k.value=d}catch(t){console.error("Error loading posts:",t)}finally{h.value=!1}}return R(()=>{S()}),(i,t)=>{const f=G("router-link");return s(),o("div",Y,[A.value?(s(),o("div",Z,[...t[1]||(t[1]=[e("div",{class:"animate-pulse space-y-4"},[e("div",{class:"w-24 h-24 mx-auto rounded-full bg-gray-200"}),e("div",{class:"h-6 w-32 mx-auto bg-gray-200 rounded"}),e("div",{class:"h-4 w-24 mx-auto bg-gray-200 rounded"})],-1)])])):a.value?(s(),o("div",se,[e("div",oe,[e("div",re,[a.value.avatar_url?(s(),o("img",{key:0,src:a.value.avatar_url,alt:a.value.display_name,class:"w-full h-full rounded-full object-cover ring-4 ring-white shadow-lg"},null,8,ae)):(s(),o("div",le,c(L.value),1))]),e("h1",ie,c(a.value.display_name),1),e("p",ne,"@"+c(a.value.username),1),e("div",ue,[e("span",{class:T(["badge",{"badge-coach":a.value.user_type==="coach","bg-blue-100 text-blue-700":a.value.user_type==="athlete","bg-gray-100 text-gray-700":a.value.user_type==="follower"}])},c(a.value.user_type.charAt(0).toUpperCase()+a.value.user_type.slice(1)),3)]),a.value.bio?(s(),o("p",de,c(a.value.bio),1)):p("",!0),m.value&&m.value.current_streak>0?(s(),o("div",ce,[t[4]||(t[4]=e("span",{class:"text-valencia-600 text-lg"},"ðŸ”¥",-1)),e("span",pe,c(m.value.current_streak)+" day streak",1),m.value.longest_streak>m.value.current_streak?(s(),o("span",me," (best: "+c(m.value.longest_streak)+") ",1)):p("",!0)])):p("",!0),a.value.user_type==="coach"&&l.value?(s(),o("div",_e,[l.value.qualifications?(s(),o("div",fe,[t[5]||(t[5]=e("p",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1"},"Qualifications",-1)),e("p",ge,c(l.value.qualifications),1)])):p("",!0),l.value.experience_years||l.value.location?(s(),o("div",ve,[l.value.experience_years?(s(),o("span",we,[t[6]||(t[6]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),w(" "+c(l.value.experience_years)+" years ",1)])):p("",!0),l.value.location?(s(),o("span",xe,[t[7]||(t[7]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),w(" "+c(l.value.location),1)])):p("",!0)])):p("",!0),l.value.specialties&&l.value.specialties.length>0?(s(),o("div",ye,[t[8]||(t[8]=e("p",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2"},"Specialties",-1)),e("div",ke,[(s(!0),o(x,null,C(l.value.specialties,d=>(s(),o("span",{key:d,class:"px-2 py-1 bg-summit-100 text-summit-800 rounded-full text-xs font-medium"},c(d),1))),128))])])):p("",!0),l.value.website_url?(s(),o("a",{key:3,href:l.value.website_url,target:"_blank",rel:"noopener noreferrer",class:"text-sm text-summit-700 hover:text-summit-800 inline-flex items-center gap-1"},[...t[9]||(t[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})],-1),w(" Visit website ",-1)])],8,he)):p("",!0),l.value.accepts_athletes&&!M.value?(s(),o("div",be,[...t[10]||(t[10]=[e("span",{class:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})]),w(" Accepting new athletes ")],-1)])])):p("",!0)])):p("",!0),e("div",Ce,[M.value?(s(),z(f,{key:0,to:"/settings",class:"btn-secondary"},{default:U(()=>[...t[11]||(t[11]=[w("Edit Profile",-1)])]),_:1})):(s(),o(x,{key:1},[t[12]||(t[12]=e("button",{class:"btn-primary"},"Follow",-1)),t[13]||(t[13]=e("button",{class:"btn-secondary"},"Message",-1))],64))])]),e("div",Pe,[t[15]||(t[15]=e("h2",{class:"font-display text-lg font-bold text-gray-900 mb-4"},"Posts",-1)),h.value?(s(),o("div",je,[(s(),o(x,null,C(2,d=>O(X,{key:d})),64))])):k.value.length===0?(s(),o("div",Ae,[...t[14]||(t[14]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("p",{class:"text-gray-500"},"No posts yet",-1)])])):(s(),o("div",Me,[(s(!0),o(x,null,C(k.value,d=>(s(),z(W,{key:d.id,post:d},null,8,["post"]))),128))]))])])):(s(),o("div",ee,[t[2]||(t[2]=e("div",{class:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 flex items-center justify-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8 h-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),t[3]||(t[3]=e("h2",{class:"font-display text-xl font-bold text-gray-900 mb-2"},"Profile not found",-1)),e("p",te,"The user @"+c(j.value)+" doesn't exist.",1),e("button",{onClick:t[0]||(t[0]=d=>I(V).push("/")),class:"btn-primary"},"Go Home")]))])}}});export{Ne as default};
