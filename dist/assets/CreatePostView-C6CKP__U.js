import{d as k,u as C,c as v,a as e,p as f,t as i,b as P,h as F,w as S,v as V,F as B,n as M,r,q as N,k as z,o as b,f as D}from"./index-B256TZ31.js";import{u as E,c as I,_ as U}from"./posts-DjeZCDHe.js";const W={class:"min-h-screen bg-white"},j={class:"sticky top-0 z-10 bg-white border-b border-feed-border"},L={class:"flex items-center justify-between px-4 h-14"},T=["disabled"],$={class:"p-4 space-y-5"},q={key:0,class:"bg-red-50 text-red-700 text-sm rounded-lg p-3"},A={class:"flex gap-2"},O=["onClick"],R={class:"block text-lg mb-0.5"},K=k({__name:"CreatePostView",setup(G){const g=z(),h=C(),n=r(""),u=r("public"),d=r([]),o=r(!1),l=r(""),c=N(()=>n.value.trim().length>0||d.value.length>0);function x(){g.back()}function y(a){d.value=a}async function w(){if(o.value||!c.value)return;const a=h.user?.id;if(a){o.value=!0,l.value="";try{const t=crypto.randomUUID(),s=[];for(const m of d.value){const p=await E(m,a,t);p&&s.push({file:m,url:p,type:m.type.startsWith("image/")?"image":"video"})}await I(a,n.value.trim(),u.value,s)?g.push("/"):l.value="Failed to create post. Please try again."}catch(t){l.value=t.message||"Something went wrong"}finally{o.value=!1}}}return(a,t)=>(b(),v("div",W,[e("header",j,[e("div",L,[e("button",{onClick:x,class:"p-1 text-gray-600 hover:text-gray-900"},[...t[1]||(t[1]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),t[2]||(t[2]=e("h1",{class:"font-display font-bold text-lg"},"New Post",-1)),e("button",{onClick:w,disabled:!c.value||o.value,class:f(["px-4 py-1.5 rounded-lg text-sm font-semibold transition-colors",c.value&&!o.value?"bg-summit-600 text-white hover:bg-summit-700":"bg-gray-200 text-gray-400 cursor-not-allowed"])},i(o.value?"Posting...":"Share"),11,T)])]),e("div",$,[l.value?(b(),v("div",q,i(l.value),1)):P("",!0),F(U,{"max-files":10,onFilesChanged:y}),e("div",null,[S(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.value=s),placeholder:"Write a caption...",rows:"4",class:"w-full border border-gray-300 rounded-lg px-3 py-2.5 text-sm focus:ring-2 focus:ring-summit-500 focus:border-summit-500 resize-none"},null,512),[[V,n.value]])]),e("div",null,[t[3]||(t[3]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Who can see this?",-1)),e("div",A,[(b(),v(B,null,M([{value:"public",label:"Everyone",icon:"ðŸŒ"},{value:"followers",label:"Followers",icon:"ðŸ‘¥"},{value:"private",label:"Only me",icon:"ðŸ”’"}],s=>e("button",{key:s.value,onClick:_=>u.value=s.value,class:f(["flex-1 py-2.5 px-3 rounded-lg text-sm font-medium text-center border transition-colors",u.value===s.value?"border-summit-500 bg-summit-50 text-summit-700":"border-gray-200 text-gray-600 hover:bg-gray-50"])},[e("span",R,i(s.icon),1),D(" "+i(s.label),1)],10,O)),64))])]),t[4]||(t[4]=e("div",{class:"h-16"},null,-1))])]))}});export{K as default};
