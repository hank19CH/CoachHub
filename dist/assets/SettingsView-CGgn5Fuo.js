import{d as le,u as se,m as ae,s as k,c as a,a as t,t as i,b as c,F as _,B as C,w as m,v as g,n as z,p as M,C as oe,g as O,f as H,r as n,q as T,k as re,o}from"./index-B256TZ31.js";const ne={class:"pb-20"},ie={class:"sticky top-0 z-10 bg-white border-b border-feed-border px-4 py-3"},ue={class:"flex items-center justify-between"},de={class:"font-display text-xl font-bold text-gray-900"},ce={class:"p-4 space-y-4"},ve={key:0,class:"p-3 bg-green-50 border border-green-200 rounded-xl text-green-700 text-sm animate-fade-in"},pe={key:1,class:"p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm"},fe={class:"card p-4"},me={class:"flex items-center gap-4 mb-4"},ge={class:"relative"},be={class:"w-20 h-20 rounded-full overflow-hidden"},ye=["src"],xe={key:1,class:"w-full h-full bg-gradient-to-br from-summit-600 to-summit-800 flex items-center justify-center text-white font-bold text-xl"},we={class:"flex-1"},he={class:"font-semibold text-gray-900"},ke={class:"text-sm text-gray-500"},_e={class:"text-sm text-gray-500"},Ce={key:0,class:"mb-4"},Se={class:"helper-text text-right"},je={key:1,class:"text-sm text-gray-700 mb-4"},Ae={class:"mb-4"},Me={key:0,class:"space-y-2"},Ee={key:0,class:"text-gray-400"},Ue={key:1,class:"text-gray-900"},$e={key:1,class:"flex flex-wrap gap-2"},Ve={key:2,class:"text-sm text-gray-400"},Be={key:2,class:"flex items-center justify-between p-3 bg-gray-50 rounded-xl"},Pe={key:2,class:"card p-4 space-y-4"},qe={class:"space-y-2"},ze={class:"flex gap-2"},Ne=["onKeypress"],De={key:0,class:"flex flex-wrap gap-2"},Fe=["onClick"],Le={class:"flex items-center justify-between p-3 bg-gray-50 rounded-xl"},Oe={key:3,class:"space-y-3"},He=["disabled"],Te={key:0,class:"flex items-center gap-2 justify-center"},Ie={key:1},Ke={class:"card p-4"},Re={class:"space-y-2"},Ye={class:"bg-white w-full sm:max-w-lg sm:rounded-2xl rounded-t-2xl max-h-[80vh] flex flex-col animate-slide-up"},We={class:"p-4 border-b border-feed-border flex items-center justify-between"},Qe={class:"overflow-y-auto flex-1 p-4"},Ge={class:"space-y-1"},Je=["onClick"],Xe={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"3"},Ze={class:"p-4 border-t border-feed-border"},lt=le({__name:"SettingsView",setup(et){const I=re(),r=se(),u=n(!1),E=n(!1),N=n(!1),v=n(""),S=n(""),b=n(""),j=n(""),y=n(!1),d=n([]),x=n(null),U=n(null),$=n(""),V=n(null),B=n(""),P=n(""),p=n([]),w=n(!0),K=n(null),q=n([]),A=n(!1),h=n(""),R=T(()=>b.value?b.value.split(" ").map(s=>s[0]).join("").toUpperCase().slice(0,2):r.profile?.display_name.split(" ").map(s=>s[0]).join("").toUpperCase().slice(0,2)||"?"),D=T(()=>U.value?U.value:r.profile?.avatar_url?r.profile.avatar_url:null);ae(async()=>{await F(),await Y()});async function F(){if(r.profile&&(b.value=r.profile.display_name,j.value=r.profile.bio||"",y.value=r.profile.is_private,d.value=r.profile.sport_ids||[],r.isCoach))try{const{data:s,error:e}=await k.from("coach_profiles").select("*").eq("id",r.user.id).single();if(e)throw e;K.value=s,$.value=s.qualifications||"",V.value=s.experience_years,B.value=s.location||"",P.value=s.website_url||"",p.value=s.specialties||[],w.value=s.accepts_athletes}catch(s){console.error("Error loading coach profile:",s)}}async function Y(){try{const{data:s,error:e}=await k.from("sports").select("id, name").eq("is_approved",!0).order("name");if(e)throw e;q.value=s||[]}catch(s){console.error("Error loading sports:",s)}}function W(s){const l=s.target.files?.[0];if(l){if(!l.type.startsWith("image/")){v.value="Please select an image file";return}if(l.size>5*1024*1024){v.value="Image must be less than 5MB";return}x.value=l;const f=new FileReader;f.onload=te=>{U.value=te.target?.result},f.readAsDataURL(l)}}async function Q(){if(!x.value||!r.user)return null;try{N.value=!0;const s=x.value.name.split(".").pop(),e=`${r.user.id}-${Date.now()}.${s}`,{error:l}=await k.storage.from("avatars").upload(e,x.value,{upsert:!0});if(l)throw l;const{data:f}=k.storage.from("avatars").getPublicUrl(e);return f.publicUrl}catch(s){return console.error("Error uploading avatar:",s),v.value="Failed to upload avatar",null}finally{N.value=!1}}function G(s){const e=d.value.indexOf(s);e>-1?d.value.splice(e,1):d.value.push(s)}function L(){h.value.trim()&&!p.value.includes(h.value.trim())&&(p.value.push(h.value.trim()),h.value="")}function J(s){p.value=p.value.filter(e=>e!==s)}async function X(){if(r.user){E.value=!0,v.value="",S.value="";try{let s=r.profile?.avatar_url||null;if(x.value){const l=await Q();l&&(s=l)}const{error:e}=await k.from("profiles").update({display_name:b.value,bio:j.value||null,is_private:y.value,sport_ids:d.value,avatar_url:s,updated_at:new Date().toISOString()}).eq("id",r.user.id);if(e)throw e;if(r.isCoach){const{error:l}=await k.from("coach_profiles").update({qualifications:$.value||null,experience_years:V.value,location:B.value||null,website_url:P.value||null,specialties:p.value,accepts_athletes:w.value}).eq("id",r.user.id);if(l)throw l}await r.fetchProfile(),S.value="Profile updated successfully!",u.value=!1,setTimeout(()=>{S.value=""},3e3)}catch(s){console.error("Error updating profile:",s),v.value=s instanceof Error?s.message:"Failed to update profile"}finally{E.value=!1}}}function Z(){u.value=!1,F(),x.value=null,U.value=null,v.value=""}async function ee(){await r.signOut(),I.push("/login")}return(s,e)=>(o(),a("div",ne,[t("div",ie,[t("div",ue,[t("h1",de,i(u.value?"Edit Profile":"Settings"),1),u.value?(o(),a("button",{key:0,onClick:Z,class:"text-gray-600 hover:text-gray-900"}," Cancel ")):c("",!0)])]),t("div",ce,[S.value?(o(),a("div",ve,i(S.value),1)):c("",!0),v.value?(o(),a("div",pe,i(v.value),1)):c("",!0),t("div",fe,[t("div",me,[t("div",ge,[t("div",be,[D.value?(o(),a("img",{key:0,src:D.value,alt:"Avatar",class:"w-full h-full object-cover"},null,8,ye)):(o(),a("div",xe,i(R.value),1))]),u.value?(o(),a("button",{key:0,onClick:e[0]||(e[0]=l=>s.$refs.avatarInput.click()),class:"absolute bottom-0 right-0 w-7 h-7 bg-summit-700 text-white rounded-full flex items-center justify-center shadow-lg hover:bg-summit-800 transition-colors"},[...e[15]||(e[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])])):c("",!0),t("input",{ref:"avatarInput",type:"file",accept:"image/*",class:"hidden",onChange:W},null,544)]),t("div",we,[u.value?(o(),a(_,{key:1},[m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>b.value=l),type:"text",placeholder:"Display Name",class:"input text-sm mb-1"},null,512),[[g,b.value]]),t("p",_e,"@"+i(C(r).profile?.username),1)],64)):(o(),a(_,{key:0},[t("h2",he,i(C(r).displayName),1),t("p",ke,"@"+i(C(r).profile?.username),1)],64))])]),u.value?(o(),a("div",Ce,[e[16]||(e[16]=t("label",{class:"label"},"Bio",-1)),m(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>j.value=l),rows:"3",placeholder:"Tell people about yourself...",class:"input resize-none",maxlength:"160"},null,512),[[g,j.value]]),t("p",Se,i(j.value.length)+"/160",1)])):C(r).profile?.bio?(o(),a("p",je,i(C(r).profile.bio),1)):c("",!0),t("div",Ae,[e[17]||(e[17]=t("label",{class:"label"},"Sports",-1)),u.value?(o(),a("div",Me,[t("button",{onClick:e[3]||(e[3]=l=>A.value=!0),class:"w-full p-3 border border-gray-200 rounded-xl text-left hover:border-summit-500 transition-colors"},[d.value.length===0?(o(),a("span",Ee," Select sports... ")):(o(),a("span",Ue,i(d.value.length)+" sport"+i(d.value.length!==1?"s":"")+" selected ",1))])])):d.value.length>0?(o(),a("div",$e,[(o(!0),a(_,null,z(d.value,l=>(o(),a("span",{key:l,class:"badge badge-coach"},i(q.value.find(f=>f.id===l)?.name||l),1))),128))])):(o(),a("p",Ve,"No sports selected"))]),u.value?(o(),a("div",Be,[e[18]||(e[18]=t("div",null,[t("p",{class:"font-medium text-gray-900"},"Private Account"),t("p",{class:"text-sm text-gray-500"},"Only followers can see your posts")],-1)),t("button",{onClick:e[4]||(e[4]=l=>y.value=!y.value),class:M(["relative w-12 h-6 rounded-full transition-colors",y.value?"bg-summit-600":"bg-gray-300"])},[t("span",{class:M(["absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform",y.value?"translate-x-6":"translate-x-0"])},null,2)],2)])):c("",!0)]),C(r).isCoach&&u.value?(o(),a("div",Pe,[e[26]||(e[26]=t("h2",{class:"font-semibold text-gray-900"},"Coach Information",-1)),t("div",null,[e[19]||(e[19]=t("label",{class:"label"},"Qualifications",-1)),m(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>$.value=l),rows:"2",placeholder:"Your coaching certifications and qualifications...",class:"input resize-none"},null,512),[[g,$.value]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"label"},"Years of Experience",-1)),m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>V.value=l),type:"number",min:"0",placeholder:"0",class:"input"},null,512),[[g,V.value,void 0,{number:!0}]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"label"},"Location",-1)),m(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>B.value=l),type:"text",placeholder:"City, Country",class:"input"},null,512),[[g,B.value]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"label"},"Website",-1)),m(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>P.value=l),type:"url",placeholder:"https://yourwebsite.com",class:"input"},null,512),[[g,P.value]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"label"},"Specialties",-1)),t("div",qe,[t("div",ze,[m(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>h.value=l),type:"text",placeholder:"Add a specialty",class:"input flex-1",onKeypress:oe(O(L,["prevent"]),["enter"])},null,40,Ne),[[g,h.value]]),t("button",{onClick:L,class:"btn-secondary px-4"}," Add ")]),p.value.length>0?(o(),a("div",De,[(o(!0),a(_,null,z(p.value,l=>(o(),a("span",{key:l,class:"inline-flex items-center gap-1 px-3 py-1 bg-summit-100 text-summit-800 rounded-full text-sm"},[H(i(l)+" ",1),t("button",{onClick:f=>J(l),class:"hover:text-summit-900"},[...e[23]||(e[23]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Fe)]))),128))])):c("",!0)])]),t("div",Le,[e[25]||(e[25]=t("div",null,[t("p",{class:"font-medium text-gray-900"},"Accepting New Athletes"),t("p",{class:"text-sm text-gray-500"},"Allow athletes to request coaching")],-1)),t("button",{onClick:e[10]||(e[10]=l=>w.value=!w.value),class:M(["relative w-12 h-6 rounded-full transition-colors",w.value?"bg-summit-600":"bg-gray-300"])},[t("span",{class:M(["absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform",w.value?"translate-x-6":"translate-x-0"])},null,2)],2)])])):c("",!0),u.value?(o(),a("div",Oe,[t("button",{onClick:X,disabled:E.value,class:"btn-primary w-full"},[E.value?(o(),a("span",Te,[...e[27]||(e[27]=[t("svg",{class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),H(" Saving... ",-1)])])):(o(),a("span",Ie,"Save Changes"))],8,He)])):c("",!0),u.value?c("",!0):(o(),a(_,{key:4},[t("div",Ke,[e[29]||(e[29]=t("h2",{class:"font-semibold text-gray-900 mb-3"},"Account",-1)),t("div",Re,[t("button",{onClick:e[11]||(e[11]=l=>u.value=!0),class:"w-full flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 transition-colors"},[...e[28]||(e[28]=[t("span",null,"Edit Profile",-1),t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5l7 7-7 7"})],-1)])])])]),t("button",{onClick:ee,class:"w-full p-4 text-red-600 font-medium rounded-xl border border-red-200 hover:bg-red-50 transition-colors"}," Sign Out "),e[30]||(e[30]=t("p",{class:"text-center text-gray-400 text-sm"}," CoachHub v0.1.0 ",-1))],64))]),A.value?(o(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black bg-opacity-50",onClick:e[14]||(e[14]=O(l=>A.value=!1,["self"]))},[t("div",Ye,[t("div",We,[e[32]||(e[32]=t("h2",{class:"font-semibold text-lg"},"Select Sports",-1)),t("button",{onClick:e[12]||(e[12]=l=>A.value=!1),class:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center"},[...e[31]||(e[31]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Qe,[t("div",Ge,[(o(!0),a(_,null,z(q.value,l=>(o(),a("button",{key:l.id,onClick:f=>G(l.id),class:"w-full flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 transition-colors"},[t("span",null,i(l.name),1),t("div",{class:M(["w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",d.value.includes(l.id)?"bg-summit-600 border-summit-600":"border-gray-300"])},[d.value.includes(l.id)?(o(),a("svg",Xe,[...e[33]||(e[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1)])])):c("",!0)],2)],8,Je))),128))])]),t("div",Ze,[t("button",{onClick:e[13]||(e[13]=l=>A.value=!1),class:"btn-primary w-full"}," Done ")])])])):c("",!0)]))}});export{lt as default};
