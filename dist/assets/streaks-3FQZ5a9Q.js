import{s as r}from"./index-DoIKaNgo.js";async function _(e){try{const{data:t}=await r.from("user_streaks").select("*").eq("user_id",e).single(),a=new Date().toISOString().split("T")[0];if(!t){await r.from("user_streaks").insert({user_id:e,current_streak:1,longest_streak:1,last_workout_date:a});return}const n=new Date(t.last_workout_date+"T00:00:00"),u=new Date(a+"T00:00:00"),s=Math.floor((u.getTime()-n.getTime())/(1e3*60*60*24));if(s===0)return;if(s===1){const o=t.current_streak+1;await r.from("user_streaks").update({current_streak:o,longest_streak:Math.max(o,t.longest_streak),last_workout_date:a}).eq("user_id",e)}else await r.from("user_streaks").update({current_streak:1,last_workout_date:a}).eq("user_id",e)}catch(t){console.error("Error updating streak:",t)}}async function c(e){try{const{data:t}=await r.from("user_streaks").select("*").eq("user_id",e).single();return t}catch{return null}}export{c as g,_ as u};
