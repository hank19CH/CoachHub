import{d as z,u as H,m as L,s as m,c as o,a as t,B as T,t as u,F as B,n as S,b as g,y as I,f as U,g as W,w as i,v as a,k as P,r as d,q as O,o as r,l as G}from"./index-B256TZ31.js";const J={class:"pb-20"},K={class:"sticky top-0 z-10 bg-white border-b border-feed-border px-4 py-3"},Q={class:"flex items-center gap-3"},X={class:"flex-1 min-w-0"},Y={class:"font-display text-lg font-bold text-gray-900 truncate"},Z={class:"text-sm text-gray-500"},ee={key:0,class:"p-6"},te={class:"space-y-4"},se={key:1,class:"p-4 space-y-4"},le={key:0,class:"card p-4"},ne={class:"text-sm text-gray-700"},oe={key:1,class:"text-center py-8"},re={key:2,class:"space-y-3"},ie={class:"flex items-start gap-3"},ae={class:"w-8 h-8 rounded-full bg-summit-100 text-summit-700 font-bold flex items-center justify-center flex-shrink-0 text-sm"},ue={class:"flex-1 min-w-0"},de={class:"font-semibold text-gray-900 mb-1"},pe={key:0,class:"text-sm text-gray-600 mb-2"},ve={class:"text-sm text-gray-500"},ce={key:1,class:"text-xs text-gray-500 mt-1"},me={class:"flex gap-1 flex-shrink-0"},ge=["onClick"],be=["onClick"],fe={class:"bg-white w-full sm:max-w-2xl sm:rounded-2xl rounded-t-2xl max-h-[90vh] flex flex-col animate-slide-up"},we={class:"p-4 border-b border-feed-border flex items-center justify-between flex-shrink-0"},ye={class:"font-semibold text-lg"},_e={class:"flex-1 overflow-y-auto p-4 space-y-4"},he={key:0,class:"p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm"},xe={class:"grid grid-cols-2 gap-4"},ke={class:"p-4 border-t border-feed-border flex-shrink-0 space-y-2"},Ce=["disabled"],Ee={key:0,class:"flex items-center gap-2 justify-center"},Ve={key:1},Se=z({__name:"WorkoutBuilderView",setup(Me){const $=G(),k=P(),C=H(),b=d(null),v=d([]),E=d(!0),f=d(!1),w=d(!1),s=d({name:"",description:"",sets:null,reps:"",weight_kg:null,duration_seconds:null,distance_meters:null,rpe:null,intensity_percent:null,target_time_seconds:null,rest_seconds:null,notes:"",video_url:""}),p=d(null),c=d(""),h=O(()=>$.params.id);L(async()=>{await j(),await x()});async function j(){if(C.user)try{const{data:l,error:e}=await m.from("workouts").select("*").eq("id",h.value).eq("coach_id",C.user.id).single();if(e)throw e;b.value=l}catch(l){console.error("Error loading workout:",l),k.push("/workouts")}finally{E.value=!1}}async function x(){try{const{data:l,error:e}=await m.from("exercises").select("*").eq("workout_id",h.value).order("order_index");if(e)throw e;v.value=l||[]}catch(l){console.error("Error loading exercises:",l)}}function V(){M(),p.value=null,w.value=!0}function A(l){s.value={name:l.name,description:l.description||"",sets:l.sets,reps:l.reps||"",weight_kg:l.weight_kg,duration_seconds:l.duration_seconds,distance_meters:l.distance_meters,rpe:l.rpe,intensity_percent:l.intensity_percent,target_time_seconds:l.target_time_seconds,rest_seconds:l.rest_seconds,notes:l.notes||"",video_url:l.video_url||""},p.value=l.id,w.value=!0}function M(){s.value={name:"",description:"",sets:null,reps:"",weight_kg:null,duration_seconds:null,distance_meters:null,rpe:null,intensity_percent:null,target_time_seconds:null,rest_seconds:null,notes:"",video_url:""},c.value=""}function y(){w.value=!1,M(),p.value=null}async function D(){if(s.value.name)try{if(f.value=!0,c.value="",p.value){const{error:l}=await m.from("exercises").update({name:s.value.name,description:s.value.description||null,sets:s.value.sets,reps:s.value.reps||null,weight_kg:s.value.weight_kg,duration_seconds:s.value.duration_seconds,distance_meters:s.value.distance_meters,rpe:s.value.rpe,intensity_percent:s.value.intensity_percent,target_time_seconds:s.value.target_time_seconds,rest_seconds:s.value.rest_seconds,notes:s.value.notes||null,video_url:s.value.video_url||null}).eq("id",p.value);if(l)throw l}else{const{error:l}=await m.from("exercises").insert({workout_id:h.value,name:s.value.name,description:s.value.description||null,order_index:v.value.length,sets:s.value.sets,reps:s.value.reps||null,weight_kg:s.value.weight_kg,duration_seconds:s.value.duration_seconds,distance_meters:s.value.distance_meters,rpe:s.value.rpe,intensity_percent:s.value.intensity_percent,target_time_seconds:s.value.target_time_seconds,rest_seconds:s.value.rest_seconds,notes:s.value.notes||null,video_url:s.value.video_url||null});if(l)throw l}await x(),y()}catch(l){console.error("Error saving exercise:",l),c.value=l instanceof Error?l.message:"Failed to save exercise"}finally{f.value=!1}}async function q(l){if(confirm("Delete this exercise?"))try{const{error:e}=await m.from("exercises").delete().eq("id",l);if(e)throw e;await x()}catch(e){console.error("Error deleting exercise:",e),alert("Failed to delete exercise")}}function F(l){const e=[];if(l.sets&&e.push(`${l.sets} sets`),l.reps&&e.push(`${l.reps} reps`),l.weight_kg&&e.push(`${l.weight_kg}kg`),l.duration_seconds){const n=Math.floor(l.duration_seconds/60),_=l.duration_seconds%60;e.push(_>0?`${n}:${_.toString().padStart(2,"0")}`:`${n}min`)}return l.distance_meters&&e.push(`${l.distance_meters}m`),l.rpe&&e.push(`RPE ${l.rpe}`),l.intensity_percent&&e.push(`${l.intensity_percent}%`),e.length>0?e.join(" â€¢ "):"No parameters set"}function N(l){if(!l)return"";const e=Math.floor(l/60),n=l%60;return`${e}:${n.toString().padStart(2,"0")}`}return(l,e)=>(r(),o("div",J,[t("div",K,[t("div",Q,[t("button",{onClick:e[0]||(e[0]=n=>T(k).push("/workouts")),class:"p-2 hover:bg-gray-100 rounded-lg -ml-2"},[...e[14]||(e[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19l-7-7 7-7"})],-1)])]),t("div",X,[t("h1",Y,u(b.value?.name||"Workout"),1),t("p",Z,u(v.value.length)+" exercise"+u(v.value.length!==1?"s":""),1)])])]),E.value?(r(),o("div",ee,[t("div",te,[(r(),o(B,null,S(3,n=>t("div",{key:n,class:"animate-pulse"},[...e[15]||(e[15]=[t("div",{class:"p-4 bg-gray-50 rounded-xl"},[t("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),t("div",{class:"h-4 bg-gray-200 rounded w-1/2"})],-1)])])),64))])])):(r(),o("div",se,[b.value?.description?(r(),o("div",le,[t("p",ne,u(b.value.description),1)])):g("",!0),v.value.length===0?(r(),o("div",oe,[e[16]||(e[16]=I('<div class="w-16 h-16 mx-auto mb-4 bg-summit-100 rounded-full flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-summit-700" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg></div><h3 class="font-semibold text-gray-900 mb-1">No exercises yet</h3><p class="text-sm text-gray-600 mb-4">Add exercises to build your workout</p>',3)),t("button",{onClick:V,class:"btn-primary"}," Add First Exercise ")])):(r(),o("div",re,[(r(!0),o(B,null,S(v.value,(n,_)=>(r(),o("div",{key:n.id,class:"card p-4"},[t("div",ie,[t("div",ae,u(_+1),1),t("div",ue,[t("h3",de,u(n.name),1),n.description?(r(),o("p",pe,u(n.description),1)):g("",!0),t("p",ve,u(F(n)),1),n.rest_seconds?(r(),o("p",ce," Rest: "+u(N(n.rest_seconds)),1)):g("",!0)]),t("div",me,[t("button",{onClick:R=>A(n),class:"p-2 hover:bg-gray-100 rounded-lg",title:"Edit"},[...e[17]||(e[17]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,ge),t("button",{onClick:R=>q(n.id),class:"p-2 hover:bg-red-100 rounded-lg",title:"Delete"},[...e[18]||(e[18]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,be)])])]))),128)),t("button",{onClick:V,class:"w-full p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-summit-500 hover:bg-summit-50 transition-colors text-gray-600 hover:text-summit-700 font-medium"},[...e[19]||(e[19]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),U(" Add Exercise ",-1)])])]))])),w.value?(r(),o("div",{key:2,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black bg-opacity-50 p-4",onClick:W(y,["self"])},[t("div",fe,[t("div",we,[t("h2",ye,u(p.value?"Edit Exercise":"Add Exercise"),1),t("button",{onClick:y,class:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center"},[...e[20]||(e[20]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",_e,[c.value?(r(),o("div",he,u(c.value),1)):g("",!0),t("div",null,[e[21]||(e[21]=t("label",{class:"label"},"Exercise Name *",-1)),i(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>s.value.name=n),type:"text",placeholder:"e.g., Back Squat",class:"input",required:""},null,512),[[a,s.value.name]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"label"},"Description / Instructions",-1)),i(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=n=>s.value.description=n),rows:"2",placeholder:"Brief instructions or notes...",class:"input resize-none"},null,512),[[a,s.value.description]])]),t("div",xe,[t("div",null,[e[23]||(e[23]=t("label",{class:"label"},"Sets",-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>s.value.sets=n),type:"number",min:"1",placeholder:"3",class:"input"},null,512),[[a,s.value.sets,void 0,{number:!0}]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"label"},"Reps",-1)),i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>s.value.reps=n),type:"text",placeholder:"8-10",class:"input"},null,512),[[a,s.value.reps]]),e[25]||(e[25]=t("p",{class:"helper-text"},"Can be range: 8-10",-1))]),t("div",null,[e[26]||(e[26]=t("label",{class:"label"},"Weight (kg)",-1)),i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>s.value.weight_kg=n),type:"number",step:"0.5",placeholder:"100",class:"input"},null,512),[[a,s.value.weight_kg,void 0,{number:!0}]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"label"},"RPE",-1)),i(t("input",{"onUpdate:modelValue":e[6]||(e[6]=n=>s.value.rpe=n),type:"number",min:"1",max:"10",step:"0.5",placeholder:"8",class:"input"},null,512),[[a,s.value.rpe,void 0,{number:!0}]]),e[28]||(e[28]=t("p",{class:"helper-text"},"1-10 scale",-1))]),t("div",null,[e[29]||(e[29]=t("label",{class:"label"},"Duration (seconds)",-1)),i(t("input",{"onUpdate:modelValue":e[7]||(e[7]=n=>s.value.duration_seconds=n),type:"number",placeholder:"60",class:"input"},null,512),[[a,s.value.duration_seconds,void 0,{number:!0}]])]),t("div",null,[e[30]||(e[30]=t("label",{class:"label"},"Distance (meters)",-1)),i(t("input",{"onUpdate:modelValue":e[8]||(e[8]=n=>s.value.distance_meters=n),type:"number",placeholder:"400",class:"input"},null,512),[[a,s.value.distance_meters,void 0,{number:!0}]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"label"},"Intensity (%)",-1)),i(t("input",{"onUpdate:modelValue":e[9]||(e[9]=n=>s.value.intensity_percent=n),type:"number",min:"0",max:"100",placeholder:"85",class:"input"},null,512),[[a,s.value.intensity_percent,void 0,{number:!0}]])]),t("div",null,[e[32]||(e[32]=t("label",{class:"label"},"Target Time (sec)",-1)),i(t("input",{"onUpdate:modelValue":e[10]||(e[10]=n=>s.value.target_time_seconds=n),type:"number",placeholder:"90",class:"input"},null,512),[[a,s.value.target_time_seconds,void 0,{number:!0}]])])]),t("div",null,[e[33]||(e[33]=t("label",{class:"label"},"Rest Between Sets (seconds)",-1)),i(t("input",{"onUpdate:modelValue":e[11]||(e[11]=n=>s.value.rest_seconds=n),type:"number",placeholder:"90",class:"input"},null,512),[[a,s.value.rest_seconds,void 0,{number:!0}]])]),t("div",null,[e[34]||(e[34]=t("label",{class:"label"},"Coach Notes",-1)),i(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=n=>s.value.notes=n),rows:"2",placeholder:"Additional notes for the athlete...",class:"input resize-none"},null,512),[[a,s.value.notes]])]),t("div",null,[e[35]||(e[35]=t("label",{class:"label"},"Demo Video URL",-1)),i(t("input",{"onUpdate:modelValue":e[13]||(e[13]=n=>s.value.video_url=n),type:"url",placeholder:"https://youtube.com/watch?v=...",class:"input"},null,512),[[a,s.value.video_url]])]),e[36]||(e[36]=t("div",{class:"p-3 bg-blue-50 border border-blue-200 rounded-xl text-sm text-blue-800"},[t("p",{class:"font-medium mb-1"},"ðŸ’¡ Flexible Structure"),t("p",null,"Only fill in the fields relevant to this exercise. Blank fields won't appear for athletes.")],-1))]),t("div",ke,[t("button",{onClick:D,disabled:!s.value.name||f.value,class:"btn-primary w-full"},[f.value?(r(),o("span",Ee,[...e[37]||(e[37]=[t("svg",{class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),U(" Saving... ",-1)])])):(r(),o("span",Ve,u(p.value?"Save Changes":"Add Exercise"),1))],8,Ce),t("button",{onClick:y,class:"btn-secondary w-full"}," Cancel ")])])])):g("",!0)]))}});export{Se as default};
