import{d as U,D as ee,m as X,c as o,a as e,t as c,f as z,b as p,w as D,v as A,F as Y,n as G,p as L,r as m,q as P,o as s,A as fe,y as te,u as oe,h as se,O as F,z as pe,B as le,x as H,l as be,k as he}from"./index-B256TZ31.js";import{c as K,a as Q,b as ye}from"./assignments-M1g5xLhx.js";import{u as we,a as ke,_ as _e}from"./posts-DjeZCDHe.js";import{_ as $e}from"./WorkoutCard.vue_vue_type_script_setup_true_lang-Dm8I2xh9.js";const Ce={class:"bg-white rounded-xl shadow-sm p-6"},Se={class:"mb-6"},Pe={class:"flex items-center justify-between mb-2"},Ee={class:"text-2xl font-bold text-gray-900"},Me={key:0,class:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},je={class:"flex flex-wrap gap-2 text-sm"},Ie={key:0,class:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full"},De={key:1,class:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full"},Be={key:2,class:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full"},Re={key:3,class:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full"},Te={key:4,class:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full"},Ve={key:5,class:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full"},We={key:6,class:"px-3 py-1 bg-blue-50 text-blue-700 rounded-full"},ze={key:0,class:"mt-4 p-3 bg-blue-50 rounded-lg"},Le={class:"text-sm text-blue-900"},Ne={class:"space-y-4"},Ae={key:0},Fe=["placeholder"],Ue={key:1},Oe=["placeholder"],qe={key:2},He=["placeholder"],Ye={key:3},Ge=["value"],Je={key:4},Ke=["placeholder"],Qe={class:"grid grid-cols-10 gap-1"},Xe=["onClick"],Ze={key:0,class:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-3"},et=["disabled"],tt=U({__name:"ExerciseLogger",props:{exercise:{},athleteId:{}},emits:["logged"],setup(l,{emit:T}){const a=l,C=T,u=m(null),x=m(""),b=m(null),y=m(null),r=m(null),g=m(null),k=m(""),d=m(!1),_=m(!1),E=m(!1);ee(()=>a.exercise.id,()=>{u.value=a.exercise.sets||null,x.value=a.exercise.reps||"",b.value=a.exercise.weight_kg||null,y.value=a.exercise.duration_seconds||null,r.value=a.exercise.distance_meters||null,g.value=a.exercise.rpe||null,k.value="",d.value=!1,E.value=!1},{immediate:!1}),X(()=>{u.value=a.exercise.sets||null,x.value=a.exercise.reps||"",b.value=a.exercise.weight_kg||null,y.value=a.exercise.duration_seconds||null,r.value=a.exercise.distance_meters||null,g.value=a.exercise.rpe||null});const M=P(()=>u.value!==null||y.value!==null||r.value!==null);let V=null;ee([b,x,y,r],()=>{M.value&&(V&&clearTimeout(V),V=setTimeout(async()=>{_.value=!0;try{if(b.value&&b.value>0&&(d.value=await K(a.athleteId,a.exercise.name,"weight",b.value),d.value)){_.value=!1;return}if(y.value&&y.value>0&&(d.value=await K(a.athleteId,a.exercise.name,"time",y.value),d.value)){_.value=!1;return}if(r.value&&r.value>0&&(d.value=await K(a.athleteId,a.exercise.name,"distance",r.value),d.value)){_.value=!1;return}d.value=!1}finally{_.value=!1}},500))});function B(){M.value&&(E.value=!0,C("logged",{exercise_id:a.exercise.id,sets_completed:u.value,reps_completed:x.value||null,weight_used_kg:b.value,duration_seconds:y.value,distance_meters:r.value,rpe:g.value,is_pb:d.value,notes:k.value||null}))}function S(I){if(!I)return"";const n=Math.floor(I/60),f=I%60;return`${n.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`}function W(I){if(!I)return null;const n=I.split(":");if(n.length!==2)return null;const f=parseInt(n[0])||0,R=parseInt(n[1])||0;return f*60+R}return(I,n)=>(s(),o("div",Ce,[e("div",Se,[e("div",Pe,[e("h2",Ee,c(l.exercise.name),1),E.value?(s(),o("span",Me,[...n[6]||(n[6]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1),z(" Logged ",-1)])])):p("",!0)]),e("div",je,[l.exercise.sets?(s(),o("span",Ie,c(l.exercise.sets)+" sets ",1)):p("",!0),l.exercise.reps?(s(),o("span",De,c(l.exercise.reps)+" reps ",1)):p("",!0),l.exercise.weight_kg?(s(),o("span",Be,c(l.exercise.weight_kg)+" kg ",1)):p("",!0),l.exercise.duration_seconds?(s(),o("span",Re,c(S(l.exercise.duration_seconds)),1)):p("",!0),l.exercise.distance_meters?(s(),o("span",Te,c(l.exercise.distance_meters)+"m ",1)):p("",!0),l.exercise.rpe?(s(),o("span",Ve," RPE "+c(l.exercise.rpe),1)):p("",!0),l.exercise.rest_seconds?(s(),o("span",We,c(l.exercise.rest_seconds)+"s rest ",1)):p("",!0)]),l.exercise.notes?(s(),o("div",ze,[e("p",Le,[n[7]||(n[7]=e("strong",null,"Coach's note:",-1)),z(" "+c(l.exercise.notes),1)])])):p("",!0)]),e("div",Ne,[l.exercise.sets!==null&&l.exercise.sets!==void 0?(s(),o("div",Ae,[n[8]||(n[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sets Completed",-1)),D(e("input",{"onUpdate:modelValue":n[0]||(n[0]=f=>u.value=f),type:"number",min:"0",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-valencia-500 focus:border-transparent text-lg",placeholder:`Prescribed: ${l.exercise.sets}`},null,8,Fe),[[A,u.value,void 0,{number:!0}]])])):p("",!0),l.exercise.reps!==null&&l.exercise.reps!==void 0?(s(),o("div",Ue,[n[9]||(n[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Reps Completed",-1)),D(e("input",{"onUpdate:modelValue":n[1]||(n[1]=f=>x.value=f),type:"text",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-valencia-500 focus:border-transparent text-lg",placeholder:`Prescribed: ${l.exercise.reps}`},null,8,Oe),[[A,x.value]])])):p("",!0),l.exercise.weight_kg!==null&&l.exercise.weight_kg!==void 0?(s(),o("div",qe,[n[10]||(n[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Weight Used (kg)",-1)),D(e("input",{"onUpdate:modelValue":n[2]||(n[2]=f=>b.value=f),type:"number",step:"0.5",min:"0",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-valencia-500 focus:border-transparent text-lg",placeholder:`Prescribed: ${l.exercise.weight_kg} kg`},null,8,He),[[A,b.value,void 0,{number:!0}]])])):p("",!0),l.exercise.duration_seconds!==null&&l.exercise.duration_seconds!==void 0?(s(),o("div",Ye,[n[11]||(n[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Duration (MM:SS)",-1)),e("input",{value:S(y.value),onInput:n[3]||(n[3]=f=>y.value=W(f.target.value)),type:"text",placeholder:"00:00",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-valencia-500 focus:border-transparent text-lg"},null,40,Ge)])):p("",!0),l.exercise.distance_meters!==null&&l.exercise.distance_meters!==void 0?(s(),o("div",Je,[n[12]||(n[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Distance (meters)",-1)),D(e("input",{"onUpdate:modelValue":n[4]||(n[4]=f=>r.value=f),type:"number",min:"0",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-valencia-500 focus:border-transparent text-lg",placeholder:`Prescribed: ${l.exercise.distance_meters}m`},null,8,Ke),[[A,r.value,void 0,{number:!0}]])])):p("",!0),e("div",null,[n[13]||(n[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[z(" RPE (Rate of Perceived Exertion) "),e("span",{class:"text-gray-400 font-normal"},"- Optional")],-1)),e("div",Qe,[(s(),o(Y,null,G(10,f=>e("button",{key:f,onClick:R=>g.value=g.value===f?null:f,class:L(["py-2 rounded-lg font-medium text-sm transition-colors",g.value===f?"bg-valencia-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},c(f),11,Xe)),64))])]),e("div",null,[n[14]||(n[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[z(" Notes "),e("span",{class:"text-gray-400 font-normal"},"- Optional")],-1)),D(e("textarea",{"onUpdate:modelValue":n[5]||(n[5]=f=>k.value=f),rows:"2",placeholder:"How did this feel?",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-valencia-500 focus:border-transparent"},null,512),[[A,k.value]])])]),d.value&&!_.value?(s(),o("div",Ze,[...n[15]||(n[15]=[e("svg",{class:"w-6 h-6 text-amber-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),e("div",null,[e("p",{class:"font-semibold text-amber-900"},"Personal Best!"),e("p",{class:"text-sm text-amber-700"},"You're crushing it!")],-1)])])):p("",!0),e("button",{onClick:B,disabled:!M.value,class:L(["mt-6 w-full py-3 px-6 rounded-lg font-medium transition-colors",[M.value?E.value?"bg-green-600 text-white hover:bg-green-700":"bg-summit-600 text-white hover:bg-summit-700":"bg-gray-300 text-gray-500 cursor-not-allowed"]])},c(E.value?"Update Log":"Log Exercise"),11,et)]))}}),st={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},lt={class:"bg-white rounded-2xl p-8 max-w-sm w-full text-center"},ot={class:"relative w-48 h-48 mx-auto mb-6"},nt={class:"w-full h-full transform -rotate-90"},at=["stroke-dasharray","stroke-dashoffset"],rt={class:"absolute inset-0 flex items-center justify-center"},it={class:"text-5xl font-bold text-gray-900"},ut={class:"flex gap-3"},dt=U({__name:"RestTimer",props:{duration:{}},emits:["complete","skip"],setup(l,{emit:T}){const a=l,C=T,u=m(a.duration),x=m(!1);let b=null;X(()=>{b=setInterval(()=>{!x.value&&u.value>0&&(u.value--,u.value===0&&(b&&clearInterval(b),C("complete")))},1e3)}),fe(()=>{b&&clearInterval(b)});function y(){x.value=!x.value}function r(){b&&clearInterval(b),C("skip")}function g(k){const d=Math.floor(k/60),_=k%60;return`${d}:${_.toString().padStart(2,"0")}`}return(k,d)=>(s(),o("div",st,[e("div",lt,[d[1]||(d[1]=e("h3",{class:"text-xl font-bold text-gray-900 mb-6"},"Rest Time",-1)),e("div",ot,[(s(),o("svg",nt,[d[0]||(d[0]=e("circle",{cx:"96",cy:"96",r:"88",fill:"none",stroke:"#E5E7EB","stroke-width":"12"},null,-1)),e("circle",{cx:"96",cy:"96",r:"88",fill:"none",stroke:"#F97316","stroke-width":"12","stroke-linecap":"round","stroke-dasharray":`${2*Math.PI*88}`,"stroke-dashoffset":`${2*Math.PI*88*(1-u.value/l.duration)}`,class:"transition-all duration-1000 ease-linear"},null,8,at)])),e("div",rt,[e("span",it,c(g(u.value)),1)])]),e("div",ut,[e("button",{onClick:y,class:"flex-1 py-3 px-6 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 font-medium"},c(x.value?"Resume":"Pause"),1),e("button",{onClick:r,class:"flex-1 py-3 px-6 bg-valencia-500 text-white rounded-lg hover:bg-valencia-600 font-medium"}," Skip Rest ")])])]))}}),ct={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},mt={class:"bg-white rounded-2xl p-8 max-w-md w-full text-center"},vt={class:"bg-gray-50 rounded-xl p-6 mb-6 space-y-3"},gt={class:"flex justify-between"},xt={class:"font-semibold text-gray-900"},ft={class:"flex justify-between"},pt={class:"font-semibold text-gray-900"},bt={class:"flex justify-between"},ht={class:"font-semibold text-gray-900"},yt={key:0,class:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-xl"},wt={class:"space-y-3"},kt=U({__name:"WorkoutCompleteModal",props:{workoutName:{},durationMinutes:{},exercisesCompleted:{},hasPbs:{type:Boolean}},emits:["close","share"],setup(l,{emit:T}){const a=T;return(C,u)=>(s(),o("div",ct,[e("div",mt,[u[7]||(u[7]=te('<div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"><svg class="w-10 h-10 text-green-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg></div><h2 class="text-2xl font-bold text-gray-900 mb-2">Workout Complete!</h2><p class="text-gray-600 mb-6">Great job crushing that session</p>',3)),e("div",vt,[e("div",gt,[u[2]||(u[2]=e("span",{class:"text-gray-600"},"Workout",-1)),e("span",xt,c(l.workoutName),1)]),e("div",ft,[u[3]||(u[3]=e("span",{class:"text-gray-600"},"Duration",-1)),e("span",pt,c(l.durationMinutes)+" minutes",1)]),e("div",bt,[u[4]||(u[4]=e("span",{class:"text-gray-600"},"Exercises",-1)),e("span",ht,c(l.exercisesCompleted),1)])]),l.hasPbs?(s(),o("div",yt,[...u[5]||(u[5]=[te('<div class="flex items-center justify-center gap-2 mb-1"><svg class="w-6 h-6 text-amber-500" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg><span class="font-bold text-amber-900">New Personal Best!</span></div><p class="text-sm text-amber-700">You set a new PR today!</p>',2)])])):p("",!0),e("div",wt,[e("button",{onClick:u[0]||(u[0]=x=>a("share")),class:"w-full py-3 px-6 bg-summit-600 text-white rounded-lg hover:bg-summit-700 font-medium flex items-center justify-center gap-2"},[...u[6]||(u[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})],-1),z(" Share Workout ",-1)])]),e("button",{onClick:u[1]||(u[1]=x=>a("close")),class:"w-full py-3 px-6 bg-white text-gray-700 rounded-lg hover:bg-gray-50 font-medium border border-gray-300"}," Back to Dashboard ")])])]))}}),_t={class:"fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50"},$t={class:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-lg max-h-[90vh] flex flex-col overflow-hidden"},Ct={class:"flex items-center justify-between px-4 py-3 border-b flex-shrink-0"},St={class:"font-semibold text-gray-900"},Pt=["disabled"],Et={class:"flex-1 overflow-y-auto"},Mt={key:0,class:"p-4 space-y-5"},jt={key:0},It={class:"flex items-center justify-between mb-2"},Dt={class:"space-y-1.5 max-h-48 overflow-y-auto"},Bt=["checked","onChange"],Rt={class:"flex-1 min-w-0"},Tt={class:"text-sm font-medium text-gray-900 truncate block"},Vt={key:0,class:"text-[10px] font-bold text-amber-600 uppercase tracking-wider"},Wt={class:"space-y-2"},zt={class:"flex items-center justify-between p-2.5 bg-gray-50 rounded-lg cursor-pointer"},Lt={class:"flex items-center justify-between p-2.5 bg-gray-50 rounded-lg cursor-pointer"},Nt={class:"flex items-center justify-between p-2.5 bg-gray-50 rounded-lg cursor-pointer"},At={class:"flex items-center justify-between p-2.5 bg-gray-50 rounded-lg cursor-pointer"},Ft={class:"flex items-center justify-between p-2.5 bg-gray-50 rounded-lg cursor-pointer"},Ut={class:"flex gap-2"},Ot=["onClick"],qt={class:"block text-lg mb-0.5"},Ht={key:1,class:"p-4 space-y-4"},Yt={key:0,class:"text-sm text-gray-900"},Gt={class:"rounded-xl overflow-hidden aspect-square max-w-[320px] mx-auto"},Jt={class:"text-xs text-gray-500 text-center"},Kt={class:"font-medium"},Qt={key:1,class:"text-sm text-red-600 text-center bg-red-50 rounded-lg p-3"},Xt={key:0,class:"p-4 border-t flex-shrink-0"},Zt=["disabled"],es={key:0,class:"flex items-center justify-center gap-2"},ts={key:1},ss=U({__name:"WorkoutShareModal",props:{completionId:{},workoutName:{},duration:{},exercisesCompleted:{},pbCount:{},exercises:{}},emits:["close","shared"],setup(l,{emit:T}){const a=l,C=T,u=oe(),x=m(""),b=m("public"),y=m([]),r=m(new Set(a.exercises.map(i=>i.id))),g=m(!1),k=m(""),d=m({show_duration:!0,show_rpe:!0,show_workout_name:!0,show_exercise_details:!0,highlight_pbs_only:!1}),_=m(1),E=P(()=>a.exercises.filter(i=>r.value.has(i.id))),M=P(()=>E.value.map(i=>({name:i.name,sets:i.sets_completed??i.sets,reps:i.reps_completed??i.reps,weight:i.weight_used_kg??i.weight_kg,duration:i.actual_duration_seconds??i.duration_seconds,distance:i.actual_distance_meters??i.distance_meters,isPb:i.isPb}))),V=P(()=>M.value.filter(i=>i.isPb).length);function B(i){const t=new Set(r.value);t.has(i)?t.delete(i):t.add(i),r.value=t}function S(){r.value=new Set(a.exercises.map(i=>i.id))}function W(){r.value=new Set}function I(i){y.value=i}function n(){_.value=2}function f(){_.value=1}async function R(){if(!g.value){g.value=!0,k.value="";try{const i=u.user?.id;if(!i)throw new Error("Not authenticated");const t=[];for(const N of y.value){const O=await we(N,i,a.completionId);O&&t.push({file:N,url:O,type:N.type.startsWith("image/")?"image":"video"})}const v=await ke({completionId:a.completionId,caption:x.value.trim(),visibility:b.value,sharedExerciseIds:Array.from(r.value),shareSettings:d.value},t);v?C("shared",v.id):k.value="Failed to create post. Please try again."}catch(i){k.value=i.message||"Something went wrong"}finally{g.value=!1}}}return(i,t)=>(s(),o("div",_t,[e("div",$t,[e("div",Ct,[_.value===2?(s(),o("button",{key:0,onClick:f,class:"text-sm text-summit-600 font-medium"}," Back ")):(s(),o("button",{key:1,onClick:t[0]||(t[0]=v=>C("close")),class:"p-1 text-gray-400 hover:text-gray-600"},[...t[8]||(t[8]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])),e("h3",St,c(_.value===1?"Share Workout":"Preview"),1),_.value===1?(s(),o("button",{key:2,onClick:n,class:"text-sm text-summit-600 font-semibold"}," Preview ")):(s(),o("button",{key:3,onClick:R,disabled:g.value,class:L(["text-sm font-semibold",g.value?"text-gray-400":"text-summit-600"])},c(g.value?"Posting...":"Post"),11,Pt))]),e("div",Et,[_.value===1?(s(),o("div",Mt,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Caption",-1)),D(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=v=>x.value=v),placeholder:"How was your workout?",rows:"3",class:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-summit-500 focus:border-summit-500 resize-none"},null,512),[[A,x.value]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Photos & Videos",-1)),se(_e,{"max-files":5,onFilesChanged:I})]),l.exercises.length>0?(s(),o("div",jt,[e("div",It,[t[11]||(t[11]=e("label",{class:"text-sm font-medium text-gray-700"},"Exercises to Show",-1)),e("button",{onClick:t[2]||(t[2]=v=>r.value.size===l.exercises.length?W():S()),class:"text-xs text-summit-600 font-medium"},c(r.value.size===l.exercises.length?"Deselect All":"Select All"),1)]),e("div",Dt,[(s(!0),o(Y,null,G(l.exercises,v=>(s(),o("label",{key:v.id,class:L(["flex items-center gap-3 p-2.5 rounded-lg cursor-pointer transition-colors",r.value.has(v.id)?"bg-summit-50":"bg-gray-50"])},[e("input",{type:"checkbox",checked:r.value.has(v.id),onChange:N=>B(v.id),class:"rounded border-gray-300 text-summit-600 focus:ring-summit-500"},null,40,Bt),e("div",Rt,[e("span",Tt,c(v.name),1),v.isPb?(s(),o("span",Vt,"PR")):p("",!0)])],2))),128))])])):p("",!0),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Card Settings",-1)),e("div",Wt,[e("label",zt,[t[12]||(t[12]=e("span",{class:"text-sm text-gray-700"},"Show workout name",-1)),D(e("input",{"onUpdate:modelValue":t[3]||(t[3]=v=>d.value.show_workout_name=v),type:"checkbox",class:"rounded border-gray-300 text-summit-600 focus:ring-summit-500"},null,512),[[F,d.value.show_workout_name]])]),e("label",Lt,[t[13]||(t[13]=e("span",{class:"text-sm text-gray-700"},"Show duration",-1)),D(e("input",{"onUpdate:modelValue":t[4]||(t[4]=v=>d.value.show_duration=v),type:"checkbox",class:"rounded border-gray-300 text-summit-600 focus:ring-summit-500"},null,512),[[F,d.value.show_duration]])]),e("label",Nt,[t[14]||(t[14]=e("span",{class:"text-sm text-gray-700"},"Show exercise details",-1)),D(e("input",{"onUpdate:modelValue":t[5]||(t[5]=v=>d.value.show_exercise_details=v),type:"checkbox",class:"rounded border-gray-300 text-summit-600 focus:ring-summit-500"},null,512),[[F,d.value.show_exercise_details]])]),e("label",At,[t[15]||(t[15]=e("span",{class:"text-sm text-gray-700"},"Show RPE",-1)),D(e("input",{"onUpdate:modelValue":t[6]||(t[6]=v=>d.value.show_rpe=v),type:"checkbox",class:"rounded border-gray-300 text-summit-600 focus:ring-summit-500"},null,512),[[F,d.value.show_rpe]])]),e("label",Ft,[t[16]||(t[16]=e("span",{class:"text-sm text-gray-700"},"Highlight PRs only",-1)),D(e("input",{"onUpdate:modelValue":t[7]||(t[7]=v=>d.value.highlight_pbs_only=v),type:"checkbox",class:"rounded border-gray-300 text-summit-600 focus:ring-summit-500"},null,512),[[F,d.value.highlight_pbs_only]])])])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Who can see this?",-1)),e("div",Ut,[(s(),o(Y,null,G([{value:"public",label:"Everyone",icon:"ðŸŒ"},{value:"followers",label:"Followers",icon:"ðŸ‘¥"},{value:"private",label:"Only me",icon:"ðŸ”’"}],v=>e("button",{key:v.value,onClick:N=>b.value=v.value,class:L(["flex-1 py-2 px-3 rounded-lg text-sm font-medium text-center border transition-colors",b.value===v.value?"border-summit-500 bg-summit-50 text-summit-700":"border-gray-200 text-gray-600 hover:bg-gray-50"])},[e("span",qt,c(v.icon),1),z(" "+c(v.label),1)],10,Ot)),64))])])])):(s(),o("div",Ht,[x.value.trim()?(s(),o("p",Yt,c(x.value),1)):p("",!0),e("div",Gt,[se($e,{"workout-name":l.workoutName,duration:l.duration,exercises:M.value,"share-settings":d.value,"pb-count":V.value},null,8,["workout-name","duration","exercises","share-settings","pb-count"])]),e("p",Jt,[t[19]||(t[19]=z(" Visible to: ",-1)),e("span",Kt,c(b.value==="public"?"Everyone":b.value==="followers"?"Followers":"Only you"),1)]),k.value?(s(),o("p",Qt,c(k.value),1)):p("",!0)]))]),_.value===2?(s(),o("div",Xt,[e("button",{onClick:R,disabled:g.value,class:L(["w-full py-3 rounded-lg font-semibold text-white transition-colors",g.value?"bg-gray-400":"bg-summit-600 hover:bg-summit-700"])},[g.value?(s(),o("span",es,[...t[20]||(t[20]=[e("svg",{class:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),z(" Sharing... ",-1)])])):(s(),o("span",ts,"Share Workout"))],10,Zt)])):p("",!0)])]))}}),ls={class:"min-h-screen bg-gray-50"},os={class:"bg-white border-b sticky top-0 z-10"},ns={class:"max-w-4xl mx-auto px-4 py-4"},as={class:"flex items-center justify-between"},rs={class:"text-center flex-1 min-w-0 px-4"},is={class:"font-semibold text-lg truncate"},us={class:"text-sm text-gray-500"},ds={class:"text-right text-sm text-gray-500"},cs={class:"mt-3 bg-gray-200 rounded-full h-2 overflow-hidden"},ms={key:0,class:"mt-3 flex justify-center gap-2 overflow-x-auto pb-1"},vs=["onClick"],gs={key:0,class:"flex items-center justify-center py-20"},xs={key:1,class:"max-w-4xl mx-auto px-4 py-8"},fs={class:"bg-red-50 text-red-800 rounded-lg p-4 mb-4"},ps={class:"text-sm mt-1"},bs={key:2,class:"max-w-4xl mx-auto px-4 py-6 pb-32"},hs={class:"mt-6 flex gap-3"},ys=["disabled"],ws={key:0,class:"flex items-center justify-center gap-2"},ks={key:1},_s={class:"mt-6 bg-white rounded-lg p-4 flex items-center justify-between text-sm text-gray-600"},Es=U({__name:"WorkoutExecutionView",setup(l){const T=be(),a=he(),C=oe(),u=T.params.id,x=m(null),b=m(!0),y=m(null),r=m(0),g=m([]),k=m(null),d=m(!1),_=m(0),E=m(!1),M=m(!1),V=m(null),B=m(!1),S=P(()=>x.value?.exercises||[]),W=P(()=>S.value.length===0?null:S.value[r.value]||null),I=P(()=>{if(S.value.length===0)return 0;const h=g.value.filter(w=>w!==null).length;return Math.round(h/S.value.length*100)}),n=P(()=>r.value===S.value.length-1),f=P(()=>g.value[r.value]!==null),R=P(()=>g.value.filter(h=>h!==null).length),i=P(()=>k.value?Math.round((Date.now()-k.value.getTime())/1e3/60):0);X(async()=>{if(!C.user?.id){a.push("/login");return}try{const h=new Date().toISOString().split("T")[0],$=(await Q.fetchAssignmentsForDate(C.user.id,h)).find(j=>j.id===u);if($)x.value=$;else{const j=new Date;j.setDate(j.getDate()-1);const q=new Date;q.setDate(q.getDate()+1);const[ve,ge]=await Promise.all([Q.fetchAssignmentsForDate(C.user.id,j.toISOString().split("T")[0]),Q.fetchAssignmentsForDate(C.user.id,q.toISOString().split("T")[0])]),Z=[...ve,...ge].find(xe=>xe.id===u);if(!Z){y.value="Workout assignment not found";return}x.value=Z}g.value=new Array(x.value.exercises?.length||0).fill(null),k.value=new Date}catch(h){y.value=h.message||"Failed to load workout"}finally{b.value=!1}});function t(h){g.value[r.value]=h}function v(){f.value&&(W.value?.rest_seconds&&!n.value?(_.value=W.value.rest_seconds,d.value=!0):n.value?J():r.value++)}function N(){d.value=!1,n.value?J():r.value++}function O(){d.value=!1,n.value?J():r.value++}function ne(){r.value>0&&r.value--}function ae(h){r.value=h}async function J(){if(!C.user?.id||!k.value||B.value)return;B.value=!0;const h=Math.round((Date.now()-k.value.getTime())/1e3/60);try{const w=g.value.filter(j=>j!==null),$=await ye(u,C.user.id,{durationMinutes:h,athleteNotes:null,overallRpe:null,exerciseResults:w});$.success?(V.value=$.completionId||null,E.value=!0):y.value=$.error||"Failed to complete workout"}catch(w){y.value=w.message}finally{B.value=!1}}const re=P(()=>S.value.map((h,w)=>{const $=g.value[w];return{id:h.id,name:h.name,sets:h.sets,reps:h.reps,weight_kg:h.weight_kg,duration_seconds:h.duration_seconds,distance_meters:h.distance_meters,sets_completed:$?.sets_completed??null,reps_completed:$?.reps_completed??null,weight_used_kg:$?.weight_used_kg??null,actual_duration_seconds:$?.duration_seconds??null,actual_distance_meters:$?.distance_meters??null,isPb:$?.is_pb??!1}})),ie=P(()=>g.value.filter(h=>h?.is_pb).length);function ue(){E.value=!1,M.value=!0}function de(h){M.value=!1,a.push("/athlete/dashboard")}function ce(){R.value>0&&!confirm("Are you sure you want to exit? Your logged exercises will not be saved.")||a.push("/athlete/dashboard")}function me(){E.value=!1,a.push("/athlete/dashboard")}return(h,w)=>(s(),o("div",ls,[e("div",os,[e("div",ns,[e("div",as,[e("button",{onClick:ce,class:"p-2 -ml-2 text-gray-600 hover:text-gray-900 rounded-lg hover:bg-gray-100"},[...w[2]||(w[2]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),e("div",rs,[e("h1",is,c(x.value?.workout?.name||"Workout"),1),e("p",us," Exercise "+c(r.value+1)+" of "+c(S.value.length),1)]),e("div",ds,c(i.value)+"m ",1)]),e("div",cs,[e("div",{class:"bg-valencia-500 h-full transition-all duration-500 ease-out",style:pe({width:`${I.value}%`})},null,4)]),S.value.length>1?(s(),o("div",ms,[(s(!0),o(Y,null,G(S.value,($,j)=>(s(),o("button",{key:$.id,onClick:q=>ae(j),class:L(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium transition-colors flex-shrink-0",[j===r.value?"bg-valencia-500 text-white":g.value[j]!==null?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"]])},c(j+1),11,vs))),128))])):p("",!0)])]),b.value?(s(),o("div",gs,[...w[3]||(w[3]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-summit-600"},null,-1)])])):y.value?(s(),o("div",xs,[e("div",fs,[w[4]||(w[4]=e("p",{class:"font-medium"},"Something went wrong",-1)),e("p",ps,c(y.value),1)]),e("button",{onClick:w[0]||(w[0]=$=>le(a).push("/athlete/dashboard")),class:"text-summit-600 hover:underline font-medium"}," Back to Dashboard ")])):(s(),o("div",bs,[W.value?(s(),H(tt,{key:W.value.id,exercise:W.value,"athlete-id":le(C).user?.id||"",onLogged:t},null,8,["exercise","athlete-id"])):p("",!0),e("div",hs,[r.value>0?(s(),o("button",{key:0,onClick:ne,class:"flex-1 py-3 px-6 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition-colors"}," Previous ")):p("",!0),e("button",{onClick:v,disabled:!f.value||B.value,class:L(["flex-1 py-3 px-6 rounded-lg font-medium transition-colors",[f.value&&!B.value?n.value?"bg-green-600 text-white hover:bg-green-700":"bg-valencia-500 text-white hover:bg-valencia-600":"bg-gray-300 text-gray-500 cursor-not-allowed"]])},[B.value?(s(),o("span",ws,[...w[5]||(w[5]=[e("svg",{class:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),z(" Saving... ",-1)])])):(s(),o("span",ks,c(n.value?"Finish Workout":"Next Exercise"),1))],10,ys)]),e("div",_s,[e("span",null,c(R.value)+" of "+c(S.value.length)+" exercises logged",1),e("span",null,c(i.value)+" min elapsed",1)])])),d.value?(s(),H(dt,{key:3,duration:_.value,onComplete:N,onSkip:O},null,8,["duration"])):p("",!0),E.value?(s(),H(kt,{key:4,"workout-name":x.value?.workout?.name||"Workout","duration-minutes":i.value,"exercises-completed":R.value,"has-pbs":g.value.some($=>$?.is_pb),onClose:me,onShare:ue},null,8,["workout-name","duration-minutes","exercises-completed","has-pbs"])):p("",!0),M.value&&V.value?(s(),H(ss,{key:5,"completion-id":V.value,"workout-name":x.value?.workout?.name||"Workout",duration:i.value,"exercises-completed":R.value,"pb-count":ie.value,exercises:re.value,onClose:w[1]||(w[1]=$=>M.value=!1),onShared:de},null,8,["completion-id","workout-name","duration","exercises-completed","pb-count","exercises"])):p("",!0)]))}});export{Es as default};
