import{s as c}from"./index-DoIKaNgo.js";async function y(t,r,o){try{const e=t.name.split(".").pop(),s=`${r}/${o}/${crypto.randomUUID()}.${e}`,{data:n,error:i}=await c.storage.from("post-media").upload(s,t,{cacheControl:"3600",upsert:!1});if(i)return console.error("Error uploading media:",i),null;const{data:{publicUrl:a}}=c.storage.from("post-media").getPublicUrl(n.path);return a}catch(e){return console.error("Error in uploadPostMedia:",e),null}}async function k(t,r){try{const{error:o}=await c.from("workout_completions").update({caption:t.caption,shared_exercise_ids:t.sharedExerciseIds,share_settings:t.shareSettings}).eq("id",t.completionId);if(o)return console.error("Error updating workout_completions:",o),null;const{data:e,error:s}=await c.from("workout_completions").select("athlete_id").eq("id",t.completionId).single();if(s||!e)return console.error("Error fetching completion:",s),null;const n={author_id:e.athlete_id,content:t.caption,post_type:"workout",workout_completion_id:t.completionId,visibility:t.visibility,is_pinned:!1,likes_count:0,comments_count:0},{data:i,error:a}=await c.from("posts").insert(n).select().single();if(a||!i)return console.error("Error creating post:",a),null;if(r.length>0){const p=r.map((d,m)=>({post_id:i.id,media_type:d.type,url:d.url,display_order:m,alt_text:`Workout media ${m+1}`})),{error:u}=await c.from("post_media").insert(p);u&&console.error("Error creating post_media:",u)}const l={post_id:i.id,media_type:"workout_card",url:null,display_order:r.length,alt_text:"Workout summary card"};return await c.from("post_media").insert(l),i}catch(o){return console.error("Error in createWorkoutPost:",o),null}}async function E(t,r,o,e){try{const s={author_id:t,content:r||null,post_type:"manual",visibility:o,is_pinned:!1,likes_count:0,comments_count:0},{data:n,error:i}=await c.from("posts").insert(s).select().single();if(i||!n)return console.error("Error creating post:",i),null;if(e.length>0){const a=e.map((p,u)=>({post_id:n.id,media_type:p.type,url:p.url,display_order:u,alt_text:`Post media ${u+1}`})),{error:l}=await c.from("post_media").insert(a);l&&console.error("Error creating post_media:",l)}return n}catch(s){return console.error("Error in createPost:",s),null}}async function g(t,r,o,e,s){try{const n=`New Personal Record! ${r} â€” ${_(o,e)}`,i={author_id:t,content:n,post_type:"pr",workout_completion_id:s??null,visibility:"public",is_pinned:!1,likes_count:0,comments_count:0},{data:a,error:l}=await c.from("posts").insert(i).select().single();return l||!a?(console.error("Error creating PR post:",l),null):a}catch(n){return console.error("Error in createPrPost:",n),null}}async function h(t,r){try{const o=`${r}-day workout streak! Consistency is key.`,e={author_id:t,content:o,post_type:"streak_milestone",visibility:"public",is_pinned:!1,likes_count:0,comments_count:0},{data:s,error:n}=await c.from("posts").insert(e).select().single();return n||!s?(console.error("Error creating streak post:",n),null):s}catch(o){return console.error("Error in createStreakPost:",o),null}}function _(t,r){switch(t){case"weight":return`${r}kg`;case"reps":return`${r} reps`;case"time":{const o=Math.floor(r/60),e=r%60;return o>0?`${o}m ${e}s`:`${e}s`}case"distance":return r>=1e3?`${(r/1e3).toFixed(1)}km`:`${r}m`;default:return`${r}`}}const w=[3,5,7,10,14,21,30,50,75,100,150,200,365];export{w as S,k as a,h as b,E as c,g as d,y as u};
