import{d as O,u as X,m as Z,s as c,c as r,a as t,f as k,w as g,v as b,b as p,F as D,n as E,A as ee,t as m,h as U,g as C,C as te,r as a,q as R,k as oe,o as l}from"./index-CR_8Ibs2.js";import{_ as se}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-DVidb-Rq.js";import{_ as re}from"./Toast.vue_vue_type_script_setup_true_lang-C6u_wdkL.js";const le={class:"pb-20"},ne={key:0,class:"p-4"},ie={class:"relative"},ae={key:1,class:"p-6"},de={class:"space-y-4"},ue={key:2,class:"p-6 text-center"},ce={key:3,class:"p-4 space-y-3"},pe={class:"flex items-start justify-between gap-3"},me=["onClick"],ve={class:"font-semibold text-gray-900 mb-1"},we={key:0,class:"text-sm text-gray-600 mb-2 line-clamp-2"},fe={class:"flex flex-wrap gap-2 text-xs text-gray-500"},ke={key:0,class:"inline-flex items-center gap-1"},ge={key:1,class:"inline-flex items-center gap-1"},he={class:"flex gap-1 flex-shrink-0"},ye=["onClick"],xe=["onClick"],_e=["onClick"],be={key:0,class:"text-center py-8 text-gray-500"},Ce={class:"bg-white w-full sm:max-w-lg sm:rounded-2xl rounded-t-2xl max-h-[90vh] flex flex-col animate-slide-up"},Me={class:"flex-1 overflow-y-auto p-4 space-y-4"},je={key:0,class:"p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm"},Ve=["value"],We={class:"p-4 border-t border-feed-border flex-shrink-0 space-y-2"},$e=["disabled"],Be={key:0,class:"flex items-center gap-2 justify-center"},De={key:1},Te=O({__name:"WorkoutsView",setup(Ee){const S=oe(),d=X(),h=a([]),M=a(!0),f=a(""),j=a(!1),y=a(!1),v=a(null),V=a(!1),N=a(""),z=a("success"),W=a(!1);function x(o,e="success"){N.value=o,z.value=e,W.value=!0}const n=a({name:"",description:"",workout_type:"",estimated_duration_min:null,is_template:!0}),_=a(!1),w=a(""),T=R(()=>{if(!f.value)return h.value;const o=f.value.toLowerCase();return h.value.filter(e=>e.name.toLowerCase().includes(o)||e.description&&e.description.toLowerCase().includes(o))}),q=R(()=>h.value.length>0),P=["Strength","Cardio","Speed & Power","Skills","Recovery","Conditioning","Mobility","Mixed"];Z(async()=>{await $()});async function $(){if(d.user)try{M.value=!0;const{data:o,error:e}=await c.from("workouts").select("*").eq("coach_id",d.user.id).is("program_week_id",null).order("created_at",{ascending:!1});if(e)throw e;h.value=o||[]}catch(o){console.error("Error loading workouts:",o)}finally{M.value=!1}}function H(){n.value={name:"",description:"",workout_type:"",estimated_duration_min:null,is_template:!0},w.value="",j.value=!0}function B(){j.value=!1,w.value=""}async function Q(){if(!(!d.user||!n.value.name))try{_.value=!0,w.value="";const{data:o,error:e}=await c.from("workouts").insert({coach_id:d.user.id,name:n.value.name,description:n.value.description||null,workout_type:n.value.workout_type||null,estimated_duration_min:n.value.estimated_duration_min,is_template:n.value.is_template}).select().single();if(e)throw e;S.push(`/workouts/${o.id}/edit`)}catch(o){console.error("Error creating workout:",o),w.value=o instanceof Error?o.message:"Failed to create workout"}finally{_.value=!1}}function L(o){S.push(`/workouts/${o}/edit`)}async function Y(o){if(d.user)try{const{data:e,error:s}=await c.from("workouts").insert({coach_id:d.user.id,name:`${o.name} (Copy)`,description:o.description,workout_type:o.workout_type,estimated_duration_min:o.estimated_duration_min,is_template:o.is_template}).select().single();if(s)throw s;const{data:u,error:A}=await c.from("exercises").select("*").eq("workout_id",o.id).order("order_index");if(A)throw A;if(u&&u.length>0){const K=u.map(i=>({workout_id:e.id,name:i.name,description:i.description,order_index:i.order_index,sets:i.sets,reps:i.reps,weight_kg:i.weight_kg,duration_seconds:i.duration_seconds,distance_meters:i.distance_meters,rpe:i.rpe,intensity_percent:i.intensity_percent,target_time_seconds:i.target_time_seconds,rest_seconds:i.rest_seconds,notes:i.notes,video_url:i.video_url})),{error:F}=await c.from("exercises").insert(K);if(F)throw F}await $(),x(`"${e.name}" duplicated successfully`)}catch(e){console.error("Error duplicating workout:",e),x("Failed to duplicate workout","error")}}function G(o){v.value=o,y.value=!0}async function I(){if(!(!d.user||!v.value)){V.value=!0;try{const{error:o}=await c.from("exercises").delete().eq("workout_id",v.value.id);if(o)throw o;const{error:e}=await c.from("workouts").delete().eq("id",v.value.id).eq("coach_id",d.user.id);if(e)throw e;y.value=!1,v.value=null,await $(),x("Workout deleted")}catch(o){console.error("Error deleting workout:",o),x("Failed to delete workout","error")}finally{V.value=!1}}}function J(o){if(!o)return"Not set";if(o<60)return`${o}min`;const e=Math.floor(o/60),s=o%60;return s>0?`${e}h ${s}min`:`${e}h`}return(o,e)=>(l(),r("div",le,[t("div",{class:"sticky top-0 z-10 bg-white border-b border-feed-border px-4 py-3"},[t("div",{class:"flex items-center justify-between"},[e[8]||(e[8]=t("h1",{class:"font-display text-xl font-bold text-gray-900"},"Workouts",-1)),t("button",{onClick:H,class:"btn-primary px-4 py-2 text-sm"},[...e[7]||(e[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),k(" New Workout ",-1)])])])]),q.value?(l(),r("div",ne,[t("div",ie,[g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>f.value=s),type:"text",placeholder:"Search workouts...",class:"input pl-10"},null,512),[[b,f.value]]),e[9]||(e[9]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])])):p("",!0),M.value?(l(),r("div",ae,[t("div",de,[(l(),r(D,null,E(3,s=>t("div",{key:s,class:"animate-pulse"},[...e[10]||(e[10]=[t("div",{class:"p-4 bg-gray-50 rounded-xl"},[t("div",{class:"h-5 bg-gray-200 rounded w-3/4 mb-2"}),t("div",{class:"h-4 bg-gray-200 rounded w-1/2"})],-1)])])),64))])])):q.value?(l(),r("div",ce,[(l(!0),r(D,null,E(T.value,s=>(l(),r("div",{key:s.id,class:"card p-4 hover:shadow-md transition-shadow"},[t("div",pe,[t("div",{onClick:u=>L(s.id),class:"flex-1 min-w-0 cursor-pointer"},[t("h3",ve,m(s.name),1),s.description?(l(),r("p",we,m(s.description),1)):p("",!0),t("div",fe,[s.workout_type?(l(),r("span",ke,[e[13]||(e[13]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),k(" "+m(s.workout_type),1)])):p("",!0),s.estimated_duration_min?(l(),r("span",ge,[e[14]||(e[14]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k(" "+m(J(s.estimated_duration_min)),1)])):p("",!0)])],8,me),t("div",he,[t("button",{onClick:C(u=>L(s.id),["stop"]),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Edit workout"},[...e[15]||(e[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,ye),t("button",{onClick:C(u=>Y(s),["stop"]),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Duplicate workout"},[...e[16]||(e[16]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])],8,xe),t("button",{onClick:C(u=>G(s),["stop"]),class:"p-2 hover:bg-red-50 rounded-lg transition-colors",title:"Delete workout"},[...e[17]||(e[17]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 text-gray-400 hover:text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,_e)])])]))),128)),T.value.length===0?(l(),r("div",be,[t("p",null,'No workouts found matching "'+m(f.value)+'"',1)])):p("",!0)])):(l(),r("div",ue,[t("div",{class:"max-w-sm mx-auto"},[e[12]||(e[12]=ee('<div class="w-20 h-20 mx-auto mb-4 bg-summit-100 rounded-full flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 text-summit-700" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg></div><h2 class="font-semibold text-lg text-gray-900 mb-2">No workouts yet</h2><p class="text-gray-600 mb-6"> Create your first workout template to assign to your athletes </p>',3)),t("button",{onClick:H,class:"btn-primary w-full"},[...e[11]||(e[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),k(" Create Your First Workout ",-1)])])])])),U(se,{open:y.value,title:"Delete Workout?",message:`Delete "${v.value?.name}"? This will also delete all exercises. This cannot be undone.`,"confirm-text":"Delete",loading:V.value,onConfirm:I,onCancel:e[1]||(e[1]=s=>y.value=!1)},null,8,["open","message","loading"]),U(re,{message:N.value,type:z.value,visible:W.value,onClose:e[2]||(e[2]=s=>W.value=!1)},null,8,["message","type","visible"]),j.value?(l(),r("div",{key:4,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black bg-opacity-50",onClick:C(B,["self"])},[t("div",Ce,[t("div",{class:"p-4 border-b border-feed-border flex items-center justify-between flex-shrink-0"},[e[19]||(e[19]=t("h2",{class:"font-semibold text-lg"},"Create Workout",-1)),t("button",{onClick:B,class:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center"},[...e[18]||(e[18]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Me,[w.value?(l(),r("div",je,m(w.value),1)):p("",!0),t("div",null,[e[20]||(e[20]=t("label",{class:"label"},"Workout Name *",-1)),g(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>n.value.name=s),type:"text",placeholder:"e.g., Lower Body Strength",class:"input",required:""},null,512),[[b,n.value.name]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"label"},"Description",-1)),g(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>n.value.description=s),rows:"3",placeholder:"Brief overview of the workout...",class:"input resize-none"},null,512),[[b,n.value.description]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"label"},"Type",-1)),g(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>n.value.workout_type=s),class:"input"},[e[22]||(e[22]=t("option",{value:""},"Select type...",-1)),(l(),r(D,null,E(P,s=>t("option",{key:s,value:s},m(s),9,Ve)),64))],512),[[te,n.value.workout_type]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"label"},"Estimated Duration (minutes)",-1)),g(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>n.value.estimated_duration_min=s),type:"number",min:"1",placeholder:"60",class:"input"},null,512),[[b,n.value.estimated_duration_min,void 0,{number:!0}]])]),e[25]||(e[25]=t("div",{class:"p-3 bg-summit-50 border border-summit-200 rounded-xl text-sm text-summit-800"},[t("p",{class:"font-medium mb-1"},"ðŸ’¡ Next Step"),t("p",null,"After creating the workout, you'll add exercises and set parameters (sets, reps, weight, etc.)")],-1))]),t("div",We,[t("button",{onClick:Q,disabled:!n.value.name||_.value,class:"btn-primary w-full"},[_.value?(l(),r("span",Be,[...e[26]||(e[26]=[t("svg",{class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),k(" Creating... ",-1)])])):(l(),r("span",De,"Create & Add Exercises"))],8,$e),t("button",{onClick:B,class:"btn-secondary w-full"}," Cancel ")])])])):p("",!0)]))}});export{Te as default};
